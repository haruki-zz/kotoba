# 计划：测试质量与发布流程

## 计划概述

### 计划目标

建立覆盖核心逻辑与关键体验的测试体系，配置持续集成与发布流水线，确保可验证的质量与可重复的交付。

### 在项目中的位置

贯穿全链路的保障层，为所有模块提供质量门禁与发布路径。

---

## 依赖关系

### 前置条件

- **前置任务**：plan_01 - 环境与基础框架搭建；plan_03 - SM-2 调度核心；plan_04 - Fastify API 与数据访问层；plan_06 - Electron 主进程与应用壳；plan_07 - 渲染层体验
- **前置数据**：测试场景与验收标准
- **前置环境**：测试框架、CI 环境可用

### 后续影响

- **后续任务**：发布与版本迭代
- **产出数据**：测试用例、CI/CD 配置、发布工件

---

## 子任务分解

**每一个子任务都必须小而具体**

- sub_plan_01 - 测试策略与分层
  - 简述：确定单元、集成、端到端的覆盖范围与优先级
- sub_plan_02 - 核心逻辑测试
  - 简述：为 SM-2 算法、数据访问与 API 编写高价值用例
- sub_plan_03 - UI 与交互测试
  - 简述：为 Home/Today/Review、Library、设置等关键路径编写交互测试
- sub_plan_04 - 性能与稳定性检查
  - 简述：设计基础性能基线与长时间运行冒烟
- sub_plan_05 - CI/CD 配置
  - 简述：设置安装、测试、构建、打包流水线与缓存策略
- sub_plan_06 - 发布与签名流程
  - 简述：规划多平台打包、签名、版本号与发布渠道
- sub_plan_07 - 质量门禁与报告
  - 简述：定义阈值（覆盖率、lint、构建）、生成报告与上传存档

---

## 技术方案

### 架构设计

测试分层：单元（纯函数与数据层）、集成（API + 数据库）、端到端（UI 关键流程）；CI 负责自动执行并生成报告；发布流水线负责打包与签名。

### 核心技术选型

- **技术1**：测试框架与 UI 测试库
- **技术2**：CI 平台与打包工具链

### 数据模型

测试数据夹具与模拟对象，包含词条、调度状态、标签、配置等；发布元数据包含版本、渠道与校验信息。

### 接口设计

提供测试命令与 CI 任务；发布命令生成工件并返回校验摘要。

---

## 执行摘要

### 输入

- 需求与验收标准
- 代码与配置

### 处理

- 编写并运行测试
- 配置 CI/CD
- 打包与签名

### 输出

- 测试报告与覆盖率
- 可安装的构建产物
- 发布与回滚指南

---

## 验收标准

**验收标准必须清晰明确**

### 功能验收

- 核心模块具备单元与集成测试，关键用户流程具备端到端测试
- CI 可自动执行 lint、测试、构建并产出报告
- 打包产物可在目标平台安装运行

### 质量验收

- 覆盖率达到预设阈值，关键分支覆盖
- 构建与发布流程可重复，版本号与签名记录完整
- 失败路径有回滚与重试方案

---

## 交付物清单

### 代码文件

- 测试用例与测试配置
- CI/CD 流水线配置
- 打包与发布脚本

### 配置文件

- 覆盖率阈值、缓存与工件路径配置

### 文档

- 测试策略、报告查看方式
- 发布与回滚说明

### 测试文件

- 单元、集成、端到端测试套件与夹具
