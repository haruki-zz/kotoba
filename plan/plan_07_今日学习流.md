# 计划：今日学习流

## 计划概述

### 计划目标
实现今日学习页面与流程，支持新增词条、AI 生成、手动微调、列表展示与快速预览。

### 在项目中的位置
连接用户录入与数据层，提供新增入口并为复习队列提供源数据。

---

## 依赖关系

### 前置条件
- 前置任务：plan_03 - 主进程 API 与基础服务；plan_05 - AI 生成与 Provider 抽象；plan_06 - 渲染端基础框架与设计体系
- 前置数据：共享 schema、生成字段规则
- 前置环境：渲染端可调用 API，表单校验可用

### 后续影响
- 后续任务：plan_08 - 复习流；plan_09 - 词库管理
- 产出数据：新增词条记录、生成日志、列表展示

---

## 子任务分解
**每一个子任务都必须小而具体**

- sub_plan_01 - 设计入口与悬浮表单
  - 简述：加号入口触发悬浮编辑页，包含必填字段与校验
- sub_plan_02 - 接入 AI 生成与手动覆盖
  - 简述：调用生成接口、展示结果、允许用户修订并覆盖
- sub_plan_03 - 保存与反馈
  - 简述：提交词条创建，提示成功/失败，关闭悬浮页
- sub_plan_04 - 列表展示与快速预览
  - 简述：展示今日新增列表，支持展开查看核心字段与编辑入口
- sub_plan_05 - 交互细节与无障碍
  - 简述：键盘操作、关闭逻辑、加载状态与错误提示
- sub_plan_06 - 状态同步与缓存
  - 简述：创建后更新本地列表缓存并刷新队列相关计数

---

## 技术方案

### 架构设计
页面组件分为入口按钮、悬浮表单、列表展示与预览组件；状态存于局部 store，数据请求通过封装的 API hooks。

### 核心技术选型
- React Hook Form + Zod：表单校验
- Zustand/请求封装：列表缓存与状态管理
- Framer Motion：悬浮页与列表预览动效

### 数据模型
创建请求包含 word、reading（可空）、context_expl、scene_desc、example、difficulty；响应返回完整词条并写入 words 表。

### 接口设计
调用创建与生成接口；列表读取今日新增词条；提供重新生成与编辑入口。

---

## 执行摘要

### 输入
- 用户输入的单词与偏好
- 生成接口与创建接口

### 处理
- 表单校验、触发生成、允许手动修改
- 保存后刷新列表与状态

### 输出
- 已创建的词条列表
- 成功/失败反馈与缓存更新

---

## 验收标准
**验收标准必须清晰明确**

### 功能验收
- 悬浮表单可录入并校验必填字段
- 生成结果可展示且可手动覆盖
- 保存成功后列表即时更新并关闭悬浮页
- 列表支持快速预览核心字段

### 质量验收
- 加载、错误、空状态反馈清晰
- 键盘与鼠标交互可用，无阻塞操作

---

## 交付物清单

### 代码文件
- 今日学习页面与组件约定：1 套

### 配置文件
- 无新增

### 文档
- 交互与状态流转说明：1 份

### 测试文件
- 表单与生成流程测试计划：1 份
