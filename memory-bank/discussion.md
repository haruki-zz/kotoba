# 会话纪要

- 角色与目标：用户希望我以“AI 系统架构师/计算机科学专家/认知科学导师/教学设计师/开源生态研究员”的视角，通过引导式提问共同完善产品功能设计，当前聚焦于产品功能，不讨论技术实现。
- 产品概念与场景：计划开发日语单词记忆工具，当前主要用户为本人，也考虑未来产品化；学习场景为日语学习，每日使用频率预估 1-2 次，每次约 20 分钟。
- 核心输入与生成：用户手动录入单词，AI 生成假名读音、带情景语境的解释、情景场景描述，以及包含语境的例句，确保例句承载完整语义信息，突出语境化差异化。
- 学习目标与节奏：每日新增词汇约 10 个，偏好间隔复习、例句浸入、情景联想。
- 语境与风格偏好：例句与场景更口语、偏生活化。
- 使用流程示例：每次 20 分钟可包含今日新词录入与学习，之后从词库抽取旧词进行复习。
- 生成容错：如 AI 生成错误，由用户手动录入/修正。
- 反馈指标：关注连续天数（daily activity heat map）、掌握度分布（单词记忆程度标记为 easy/medium/hard）。
- 词条最小字段：单词本身、假名读音、情景化解释、场景描述、例句、难度标记（easy/medium/hard）、SM-2 相关字段；暂不加入词性/标签/来源等其他信息。
- SM-2 字段定义：EF（easiness factor，默认 2.5）、interval_days（当前间隔，天）、repetition（连续记忆成功次数）、last_review_at（上次复习时间，ISO 日期/时间）、next_due_at（下次到期时间，ISO 日期/时间）。
- SM-2 更新逻辑（常用值）：质量映射 easy=5、medium=4、hard=3；q<3 视为失败且不使用；若 q<3 则 repetition=0，interval=1；否则 repetition+1，若 repetition=1 则 interval=1，repetition=2 则 interval=6，之后 interval=round(prev_interval*EF)；EF'=EF+(0.1-(5-q)*(0.08+(5-q)*0.02))，EF' 下限 1.3；next_due_at=last_review_at+interval_days（仅在调度字段变更或未显式提供 next_due_at 时重算，允许保留手动导入的到期时间）。
- 复习调度与流程：采用 SRS SM-2 算法；复习时先仅显示单词，用户回忆读音与解释；若直接跳过则后端自动标记为 easy 并进入下一词；若展开查看读音/解释/情景/例句后，用户可手动选择掌握程度（若不选则默认 medium）；队列支持左右箭头/快捷键双向切换，提供“回退上一条”按钮，每日复习次数不限；跳过后无额外提示，节奏不变；当日完成后直接结束，不提示“再练 5 个 hard”。
- 数据展示：统计数据（连续天数热力图、掌握度分布等）在首页常驻展示。
- 数量与队列：每日新增词汇不设上下限，完全由用户决定；每日复习队列默认 30 个词，可用户自定义调整。
- 未标记处理：用户未选择掌握程度且也未选择“熟记”时，默认将该单词标记为 medium。
- v1 功能草案（拟定）：
  - 词条：新增/查看/编辑，字段为词、假名、情景化解释、场景描述、生活化例句、难度标记、SM-2 字段；支持 AI 生成与手动覆盖。
  - 学习流程：1）今日新词录入并生成；2）快速自检/微调内容；3）自动加入 SM-2 队列。
  - 复习流程：按 SM-2 排序；初始仅展示单词，无按钮；用户可跳过（后端自动标记 easy 并进入下一词）或展开查看详情后手动标记掌握程度（未选默认 medium）；支持左右箭头/快捷键在队列中双向切换并提供回退上一条；跳过后无提示，节奏不变；当日完成后直接结束。
  - 统计与反馈：首页常驻连续天数热力图、掌握度分布（easy/medium/hard）、今日/本周新增与复习计数；高遗忘风险提示展示 5 个 hard 词（随机）。
  - 首页/概览：连续天数热力图、掌握度分布、高遗忘风险 5 个 hard 词。
  - 今日学习：展示当日新增列表，支持快速预览与修改；包含新增词条入口（加号按钮），进入悬浮二级页面，背景虚化。
  - 复习：SM-2 队列呈现；默认仅展示单词，无“熟记”按钮；用户可跳过（后端自动标记 easy 并下一条）或“展开详情”查看假名/解释/场景/例句并选择掌握度（easy/medium/hard，未选默认 medium）；支持左右箭头/快捷键双向切换并含实体“回退上一条”按钮（快捷键 Ctrl+Z）；进度条显示今日剩余数量；跳过后无额外提示，节奏不变；当日完成后直接结束，不提示“再练 5 个 hard”；空队列文案：今日复习已完成，去巩固新增或放松一下吧，并提供“去今日学习”“去词库”入口。
  - 词条查看/编辑：列表+搜索；详情页支持重生成或手动覆盖各字段；编辑为悬浮二级页面、背景虚化。
  - 设置：复习队列默认 30 可自定义；例句风格=生活口语（例句 15-25 字，场景 1 句 30-40 字）；AI provider 选择；light/dark mode 切换。（词库导入/导出功能暂不提供）
- v1 界面元素清单与页面流转草图（概念）：
  - 导航/入口：左侧导航含：首页、今日学习、复习、词库、设置；默认落点为首页。
  - 首页：连续天数热力图；掌握度分布环形图；高遗忘风险 5 个 hard 词卡片（随机，点击进入详情页，与普通词详情一致，不触发复习）；本周新增与复习计数的折线图；今日新增/复习计数展示，无目标进度。
  - 今日学习：当日新增词列表（卡片含词+假名+简短情景提示）；加号按钮→悬浮二级页（输入词→生成→可编辑假名/解释/场景/例句/标记）；保存后回到列表。
  - 复习：按 SM-2 队列；默认仅展示单词，无“熟记”按钮；用户可跳过（后端自动标记 easy 并下一条）或“展开详情”查看假名/解释/场景/例句并选择掌握度（easy/medium/hard，未选默认 medium）；支持左右箭头/快捷键双向切换并含“回退上一条”按钮；进度条显示今日剩余数量；跳过后无额外提示，节奏不变；当日完成后直接结束，不提示“再练 5 个 hard”。
  - 词库：列表+搜索；点击词条打开悬浮详情页（显示全部字段与编辑、删除按钮）；删除含二次确认，确认后永久删除；“重生成/手动编辑”模式，保存或取消。
  - 设置：复习队列上限（默认 30，可输入）；例句风格选择（生活口语默认，例句长度 15-25 字，场景描述 1 句 30-40 字）；AI provider 选择；light/dark 切换。
  - 页面流转：导航进入各页；今日学习/词库的加号或词条点击打开悬浮编辑页；复习结束返回上层或提示已完成。
- 体验与规则补充：
  - 今日学习与复习为独立行为，无自动衔接；新词录入后不自动进入当日复习。
  - 高遗忘风险：从 hard 标记中随机展示 5 个。
  - 连续天数：断签不可补打卡。
  - 重生成：详情页重生成时保留原版，可回滚。
- 用户画像（初步）：生活在日本的外国人，能将日常遇到的新词记录并自用，未来考虑对外开放。
- 核心痛点：语境贫乏、释义不清晰、复习负担大。
- 成功指标（首要）：保持每日活跃，养成良好的记忆/复习习惯。
- 首批最重要模块：高质量生成（语境化释义/例句）、SM-2 复习体验、统计反馈（热力图/掌握度分布）、词库管理/编辑。
- 语境风格：不做过多场景约束，关注单词本身的情感与语义信息，生成需体现语境而非固定场景。
